<template>
	<div class="punch-page-wrapper dark:bg-slate-700 bg-white rounded-[24px] p-3 xl:p-6">
		<div class="w-full flex gap-2">
			<div class="grow page-data">
				<PageHeading text="Introduction" addOnClass="text-left" markedAs="intro" />
				<p class="text-slate-900 dark:text-white my-5">
					á» bÃ i nÃ y, chÃºng ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu vá» <b>Database</b> vÃ  cÃ¡ch lÃ m viá»‡c cÆ¡ báº£n vá»›i nÃ³ trong Laravel.
				</p>

				<PageHeading text="Database" addOnClass="text-left" markedAs="laravel-database" :lvl="1" />
				<p class="text-slate-900 dark:text-white my-5">
					Laravel há»— trá»£ chÃºng ta vá» viá»‡c káº¿t ná»‘i vÃ  thao tÃ¡c vá»›i database má»™t cÃ¡ch Ä‘Æ¡n giáº£n vÃ  máº¡nh máº½. Hiá»‡n táº¡i
					Laravel há»— trá»£ viá»‡c táº¡o query, ORM vá»›i má»™t sá»‘ cÃ¡c databases phá»• biáº¿n nhÆ°:
					<br />
					<b class="px-5">- MariaDB 10.3+</b>
					<br />
					<b class="px-5">- MySQL 5.7+</b>
					<br />
					<b class="px-5">- PostgreSQL 10.0+</b>
					<br />
					<b class="px-5">- SQLite 3.35.0+</b>
					<br />
					<b class="px-5">- SQL Server 2017+</b>
				</p>

				<PageHeading text="B1 - Setup Database" addOnClass="text-left" markedAs="database-setup" :lvl="2" />
				<p class="text-slate-900 dark:text-white my-3">
					Laravel cung cáº¥p má»™t file cáº¥u hÃ¬nh cho cÃ¡c káº¿t ná»‘i database náº±m trong file <b>config/database.php</b>. Tuy
					nhiÃªn, chÃºng ta thÆ°á»ng cáº¥u hÃ¬nh cÃ¡c thÃ´ng sá»‘ káº¿t ná»‘i trong file <b>.env</b>. á» Ä‘Ã¢y, chÃºng ta sáº½ lá»±a chá»n MySQL
					Ä‘á»ƒ cáº¥u hÃ¬nh. File <b>.env</b> cá»§a chÃºng ta nhÆ° sau:
				</p>
				<VCodeBlock :code="b1" highlightjs lang="php" theme="vs2015" />

				<p class="text-slate-900 dark:text-white my-3">
					Tiáº¿p Ä‘áº¿n lÃ  cáº¥u hÃ¬nh file <b>config/database.php</b> Ä‘á»ƒ nÃ³ Ä‘á»c thÃ´ng sá»‘ tá»« file <b>.env</b> mÃ  chÃºng mÃ¬nh vá»«a
					cáº¥u hÃ¬nh á»Ÿ trÃªn
				</p>
				<VCodeBlock :code="b2" highlightjs lang="php" theme="vs2015" />
				<p class="text-slate-900 dark:text-white my-3">
					Vá» cÆ¡ báº£n, chÃºng ta lÃ m 2 viá»‡c lÃ  Ä‘iá»u chá»‰nh láº¡i default database cá»§a app Ä‘á»ƒ sá»­ dá»¥ng <b>mysql</b> thay vÃ¬
					<b>sqlite</b> báº±ng config <FilePath>default' => env('DB_CONNECTION', 'mysql')</FilePath>. Laravel sá»­ dá»¥ng
					method <b>env('...', 'forge')</b> Ä‘á»ƒ Ä‘á»c cÃ¡c trÆ°á»ng tÆ°Æ¡ng á»©ng á»Ÿ bÃªn file
					<b>.env</b>
					cá»§a chÃºng ta.
				</p>
				<PageHeading text="B2 - Migration" addOnClass="text-left" markedAs="database-migration" :lvl="2" />
				<p class="text-slate-900 dark:text-white my-3">
					BÆ°á»›c thá»© 2 chÃºng ta sáº½ táº¡o ra cÃ¡c migrations Ä‘á»ƒ lÃ m viá»‡c vá»›i database. Migration lÃ  cÃ¡ch Laravel quáº£n lÃ½ vÃ 
					duy trÃ¬ cáº¥u trÃºc cá»§a database. NÃ³ cho phÃ©p chÃºng ta dÃ¹ng PHP Ä‘á»ƒ táº¡o vÃ  cáº­p nháº­t báº£ng mÃ  khÃ´ng cáº§n viáº¿t SQL
					trá»±c tiáº¿p.
					<br />
					<br />
					Cháº¡y lá»‡nh migrate cá»§a artisan á»Ÿ terminal Ä‘á»ƒ cháº¡y táº¥t cáº£ cÃ¡c migration chÆ°a Ä‘Æ°á»£c thá»±c hiá»‡n:
				</p>
				<FakeTerminalUI :textCoppy="'php artisan migrate'">
					<p>php artisan migrate</p>
				</FakeTerminalUI>
				<div class="flex gap-3">
					<div>
						<p class="text-slate-900 dark:text-white my-3">
							Trong trÆ°á»ng há»£p chÃºng ta chÆ°a táº¡o local connection vá»›i database thÃ¬ artisan migrate sáº½ Ä‘Æ°a ra yÃªu cáº§u
							khá»Ÿi táº¡o, báº¡n type 'yes' Ä‘á»ƒ táº¡o ra connection vá»›i database.
							<br />
							<br />
							sau Ä‘Ã³ sá»­ dá»¥ng cÃ¡c application Ä‘á»ƒ view database cá»§a báº¡n nhÆ° Workbench, Navicat ... hoáº·c truy cáº­p
							http://localhost/phpmyadmin cá»§a XAMPP Ä‘á»ƒ kiá»ƒm tra connection cá»§a chÃºng ta.
						</p>
					</div>
					<div>
						<img src="@/assets/images/documentation/database-1.png" alt="" class="rounded-lg w-[320px]" />
						<p class="text-slate-900 dark:text-white my-3 italic text-xs text-center">
							Connection & Database view trÃªn http://localhost/phpmyadmin
						</p>
					</div>
				</div>
				<PageHeading text="B3 - Táº¡o báº£ng" addOnClass="text-left" markedAs="database-create-table" :lvl="2" />
				<p class="text-slate-900 dark:text-white my-3">
					Tá»± táº¡o má»™t migration Ä‘á»ƒ táº¡o báº£ng <b>Todo</b> cá»§a chÃºng ta, Tiáº¿p tá»¥c sá»­ dá»¥ng <b>artisan make:migration</b> Ä‘á»ƒ
					táº¡o ra file Ä‘á»‹nh nghÄ©a cáº¥u trÃºc báº£ng
				</p>
				<FakeTerminalUI :textCoppy="'php artisan make:migration create_todos_table'">
					<p>php artisan make:migration create_todos_table</p>
				</FakeTerminalUI>
				<p class="text-slate-900 dark:text-white my-3">
					Laravel sáº½ táº¡o cho chÃºng ta má»™t file migration trong <b>database/migrations</b> vá»›i tÃªn lÃ 
					<b>*time*create_todos_table.php</b>
					<br />
					Trong file migration nÃ y lÃ  má»™t Class chá»©a 2 method lÃ  <b>up()</b> vÃ  <b>down()</b> Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c khi
					cháº¡y migration hoáº·c rollback. Trong Ä‘Ã³ <b>up()</b> lÃ  nÆ¡i Ä‘á»ƒ chÃºng ta Ä‘á»‹nh nghÄ©a báº£ng, thÃªm cá»™t hay thá»±c hiá»‡n
					thay Ä‘á»•i nÃ³i chung
				</p>
				<div class="flex gap-4">
					<div class="w-full">
						<VCodeBlock :code="b3" highlightjs lang="php" theme="vs2015" />
					</div>
					<div>
						<img src="@/assets/images/documentation/database-2.png" alt="" class="rounded-lg min-w-[450px]" />
						<p class="text-slate-900 dark:text-white my-3 italic text-xs text-center">File migration</p>
					</div>
				</div>
				<p class="text-slate-900 dark:text-white my-3">
					Sau khi Ä‘Ã£ hoÃ n thÃ nh viá»‡c khai bÃ¡o/thiáº¿t káº¿ table thÃ¬ ta sáº½ pháº£i cháº¡y láº¡i migrate Ä‘á»ƒ thá»±c thi cÃ¡c file
					migration má»›i.
				</p>
				<FakeTerminalUI :textCoppy="'php artisan migrate'">
					<p>php artisan migrate</p>
				</FakeTerminalUI>
				<div class="py-2"></div>
				<p class="text-slate-900 dark:text-white my-3">
					<b class="text-xl">XoÃ¡ / Update báº£ng</b>
					<br />
					<br />
					Trong trÆ°á»ng há»£p chÃºng ta táº¡o sai báº£ng, vÃ  cáº§n pháº£i xoÃ¡ Ä‘i Ä‘á»ƒ táº¡o láº¡i thay vÃ¬ update thÃ¬ chÃºng ta cáº§n rollback
					láº§n lÆ°á»£t báº±ng lá»‡nh:
				</p>
				<FakeTerminalUI :textCoppy="'php artisan migrate:rollback'">
					<p>php artisan migrate:rollback</p>
				</FakeTerminalUI>
				<p class="text-slate-900 dark:text-white my-3">
					CÃ²n náº¿u chá»‰ thiáº¿u cá»™t hoáº·c muá»‘n update Ä‘á»ƒ thÃªm tÃ­nh nÄƒng thÃ¬ ta cáº§n táº¡o file migration riÃªng Ä‘á»ƒ thao tÃ¡c chá»©
					khÃ´ng Ä‘Æ°á»£c sá»­a cÃ¡c file migration Ä‘Ã£ táº¡o. VÃ­ dá»¥, á»Ÿ báº£ng <b>todos</b> á»Ÿ trÃªn tÃ´i muá»‘n cÃ³ thÃªm má»™t cá»™t
					<b>title</b> thÃ¬ thay vÃ¬ update vÃ o file migration cÅ©, tÃ´i cáº§n pháº£i táº¡o háº³n 1 file migration má»›i Ä‘á»ƒ trÃ¡nh viá»‡c
					conflict.
				</p>
				<FakeTerminalUI :textCoppy="'php artisan make:migration update_title_to_todos_table'">
					<p>php artisan make:migration update_title_to_todos_table</p>
				</FakeTerminalUI>
				<VCodeBlock :code="b4" highlightjs lang="php" theme="vs2015" />
				<p class="text-slate-900 dark:text-white my-3">Tiáº¿p theo Ä‘Æ°Æ¡ng nhiÃªn pháº£i cháº¡y láº¡i migrate</p>
				<FakeTerminalUI :textCoppy="'php artisan migrate'">
					<p>php artisan migrate</p>
				</FakeTerminalUI>

				<p class="text-slate-900 dark:text-white my-3">
					á» Ä‘Ã¢y chÃºng ta cÃ²n cáº§n táº¡o má»™t báº£ng <b>`todo_statuses`</b> Ä‘á»ƒ chÆ°a cÃ¡c tráº¡ng thÃ¡i cá»§a Todo. ÄÃ¢y sáº½ lÃ  bÃ i táº­p
					cho cÃ¡c báº¡n.
				</p>
				<p class="text-slate-900 dark:text-white my-3">
					Done !!! á» trÃªn lÃ  cÃ¡c thao tÃ¡c cÆ¡ báº£n vá»›i database trong Laravel. á» bÃ i tiáº¿p theo chÃºng ta sáº½ cÃ¹ng tÃ¬m hiá»ƒu
					sÃ¢u hÆ¡n vá» ORM vÃ  Query Database ğŸ¤“.
				</p>
				<doc-next-page :pagination="pagePagination" />
			</div>
			<PageMarkBook />
		</div>
	</div>
</template>
<script lang="ts">
	import PageMarkBook from '@/components/Documentation/PageMarkBook.vue';
	import PageHeading from '@/components/Documentation/PageHeading.vue';
	import FakeTerminalUI from '@/components/FakeTerminalUI.vue';
	import { apiResponde } from '@/models';
	import DocNextPage from '@/components/DocNextPage.vue';
	import { Disclosure, DisclosureButton, DisclosurePanel } from '@headlessui/vue';
	import VCodeBlock from '@wdns/vue-code-block';
	import { FilePath } from '../../../.nuxt/components';
	export default {
		components: {
			PageMarkBook,
			PageHeading,
			FakeTerminalUI,
			DocNextPage,
			Disclosure,
			DisclosureButton,
			DisclosurePanel,
			VCodeBlock,
		},
		data() {
			return {
				b1: `DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=hello_laravel
DB_USERNAME=root
DB_PASSWORD=
`,
				b2: `'default' => env('DB_CONNECTION', 'mysql'),
...
'connections' => [
	'mysql' => [
					'driver' => 'mysql',
					'url' => env('DATABASE_URL'),
					'host' => env('DB_HOST', '127.0.0.1'),
					'port' => env('DB_PORT', '3306'),
					'database' => env('DB_DATABASE', 'forge'),
					'username' => env('DB_USERNAME', 'forge'),
					'password' => env('DB_PASSWORD', ''),
					...
					],
					...
	],
	...
`,
				b3: `public function up()
{
    Schema::create('todos', function (Blueprint $table) {
        $table->id();
        $table->string('content');
        $table->integer('status_id');
        $table->timestamps();
    });
}
`,
				b4: `// file:  time*update_title_to_todos_table.php
public function up(): void
{
		Schema::table('todos', function (Blueprint $table) {
				//
				$table->string('title');
		});
}
// ...down
`,
				b5: `namespace App/Models;

use Illuminate/Database/Eloquent/Factories/HasFactory;
use Illuminate/Database/Eloquent/Model;

/**
 * Class Todo
 * @package App/Models
 *
 * @property string $title
 * @property string $content
 * @property int $status_id
 *
 * Accessors
 *
 * Relations
 *
 *
 */
class Todo extends Model
{
		use HasFactory;

		protected $table;

		protected $fillable = ['title', 'content', 'status_id'];

		protected $casts = [
			'updated_at' => 'datetime',
			'created_at'=>'datetime'
    ];
}
`,
				pagePagination: {
					next: {
						title: 'HTML Styles',
						link: '/html-css-js-basic/documentation/ep-2',
					},
					prev: {
						title: 'Trá»Ÿ vá» danh sÃ¡ch Doc',
						link: '/html-css-js-basic/documentation',
					},
				},
			};
		},
		mounted() {
			this.getPagination();
		},
		methods: {
			getPagination() {
				this.$api.documentations.getPagination({ appIds: 'php', currentDocId: 'php-17' }).then((res: apiResponde) => {
					this.pagePagination = res?.data?.pagination || [];
				});
			},
		},
	};
</script>
